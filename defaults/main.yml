---
# Install by default
apb_action: provision

# Assume the cluster type is kubernetes
cluster: kubernetes

# Broker configuration values
broker_name: automation-broker
broker_namespace: "{{ broker_name }}"

# The image to use for the broker
broker_image: ansibleplaybookbundle/origin-ansible-service-broker:latest
broker_image_pull_policy: "IfNotPresent"

# The kind of broker, useful in the case the service-catalog
# supports namespaced service brokers
broker_kind: ClusterServiceBroker
broker_clusterrole: admin
broker_sandbox_role: edit

# How does broker save state? crd | etcd
# TODO: Support etcd
broker_dao_type: crd

# Whether or not to keep the sandbox namespace
broker_keep_namespace: "false"
broker_keep_namespace_on_error: "true"

# Special broker config options
broker_dev: "true"
broker_bootstrap_on_startup: "true"
broker_refresh_interval: "600s"
broker_launch_apb_on_bind: "false"
broker_output_request: "true"
broker_recovery: "true"
broker_auto_escalate: "false"

# Basic auth configuration, disabled by default
broker_basic_auth_enabled: false
broker_basic_auth_username: "admin"
broker_basic_auth_password: "admin"

# Flags for enabling/disabling specific registries, these are used in conjunction
# with the 'registries' config below.
dockerhub_enabled: true
local_openshift_enabled: "{{ true if cluster == 'openshift' else false }}"
helm_enabled: false

# Broker dockerhub registry options
# TODO: Support multiple dockerhub registries
broker_dockerhub_enabled: true
broker_dockerhub_name: dh
broker_dockerhub_url: https://registry.hub.docker.com
broker_dockerhub_org: ansibleplaybookbundle
broker_dockerhub_tag: latest
broker_dockerhub_white_list: [ ".*-apb$" ]

# Broker local openshift registry options
# TODO: Support multiple local openshift registries
broker_local_openshift_enabled: "{{ true if cluster == 'openshift' else false }}"
broker_local_openshift_name: localregistry
broker_local_openshift_namespaces: [ "openshift" ]
# NOTE TO ADMINS: The default whitelist policy here will pass *all* APBs
# found in the local openshift registry. If this is not desired,
# manipulate the following regex to only match APBs you wish to be made available.
broker_local_openshift_white_list: [ ".*" ]

# Broker helm registry options
# TODO: Support multiple helm type registries
broker_helm_enabled: false
broker_helm_name: stable
broker_helm_url: https://kubernetes-charts.storage.googleapis.com
broker_helm_runner: docker.io/djzager/helm-runner:latest
broker_helm_white_list: [ ".*" ]
